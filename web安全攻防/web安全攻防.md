# web安全攻防

## 1.渗透测试之信息收集

### 收集域名信息方法

获取域名注册信息，包括该域名的dns服务器信息和注册人的联系信息

#### Whois查询

* "whois" 查询是一种用于查找互联网域名、IP地址和自治系统号 (ASN) 等信息的网络工具。它允许用户查找和检索有关互联网资源（如域名、IP地址和组织）的注册信息。
* 查询域名是否已被注册及注册域名的详细信息
* 挖出域名所有人的信息。
* 爱站工具网、站长之家、virustotal

#### 备案信息查询

* icp备案、天眼查

#### 收集敏感信息

使用***谷歌***收集敏感信息

| 关键字   | 说明                                       |
| -------- | ------------------------------------------ |
| Site     | 指定域名                                   |
| Inurl    | url中存在关键字的网页                      |
| Intext   | 网页正文中的关键字                         |
| Filetype | 指定文件类型                               |
| Intitle  | 网页标题中的关键字                         |
| link     | link:baidu.com 表示返回和百度做了链接的url |
| info     | 查找指定网站的一些基本信息                 |
| cache    | 搜索Google里关于某些内容的缓存             |

ep.site:edu.cn intext:后台管理

* 收集数据库文件、sql注入、配置信息、源代码泄露等
* 百度、bing等均可
* 通过乌云漏洞表查询历史漏洞信息

#### 收集子域名信息

子域名是域名的一部分，它位于主域名之前，通常用于创建网站的不同部分或用途。子域名允许组织将其网站分成各种部分，并使用不同的子域名来识别这些部分。子域名也可以用于创建特定功能或服务的子部分。

例如，在 "blog.example.com" 中，"blog" 是一个子域名，用于指代网站的博客部分。博客可以位于主域名 "example.com" 下的子域名 "blog" 中。

##### 子域名检测工具

* layer子域名挖掘机、sublist3r、subdomiansbruite

##### 搜索引擎枚举

* 利用Google搜索site:baidu.com

##### 第三方应用聚合

* dnsdunpster、http://crt.sh

#### 收集常用端口信息（端口探测）

扫描开放的端口以及从该端口判断服务器上存在的服务。

常用工具：Nmap、Masscan、Zmap、御剑

#### 指纹识别（网站cms指纹、计算机操作系统指纹、web容器指纹）

网站CMS（内容管理系统）指纹是一种技术，用于识别和确定一个网站使用的特定CMS或网站构建工具。CMS是一种用于创建、管理和发布网站内容的软件或平台，如WordPress、Joomla、Drupal等。通过进行CMS指纹识别，可以识别目标网站所使用的CMS，并了解网站的技术栈和特性。

* **指纹识别方法** ：CMS指纹识别通常通过分析目标网站的HTML、CSS、JavaScript和其他元数据来实现。每个CMS通常具有其独特的特征、标志和文件结构，这些特征可以用于确定CMS类型。

#### 查找真实IP

通过域名确定真实ip。

##### CDN（内容分发网络）

一组在不同运营商之间的对接节点上的高速缓存服务器，把用户经常访问的静态数据资源(例如静态的html、css、js图片等文件)直接缓存到节点服务器上，当用户再次请求时，会直接分发到在离用户近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程Web服务器上响应，这样可以大大提高网站的响应速度及用户体验。

**如果目标用户使用CDN，那么ping域名得到的就不是真正的目标ip。**

##### 判断目标是否使用了CDN

使用ping或者www.17ce.com

##### 绕过CDN寻找真实ip

* 内部源邮箱：寻找邮件头中的邮件服务器域名IP，ping这个域名就可以获得真实地址
* 扫描网站测试文件：phpinfo、test等
* 分站域名：一些分站可能没有挂cdn，ping二级域名ip，可能有些分站和主站在同一个IP网段的C段上
* 国外访问：asm.ca.com/en/ping.php
* 查询域名解析记录：可能有些网站以前没用cdn，通过www.netcraft.com观察历史IP记录。
* www.cloudflare.us/cfs.html#box

##### 验证获取的IP

直接在浏览器访问ip看页面是否一样，或借助工具扫描对应ip段的开了80、443、8080端口的ip地址

#### 收集敏感目录文件

探测web目录结构和隐藏的敏感文件

* DirBuster、www.webscan.cc/

社会工程学

社工库

## 2.搭建漏洞环境及实战
