(

APSB模型的贝叶斯混合策略纳什均衡由一组策略组合（θ* ，a* ）及推断P~组成。它满足以下要求：

（1）θ* 是使得等式（ud）取得最大值的点

（2）P~（ti|a1）是攻击方利用贝叶斯规则根据观察到防御方的行动a1、先验概率p以及防御方的最优策略θ* 得到。

（3）a * 是使得等式（Ua）最大的点

在上述定义中，θ（* ）表示防御者以此概率对收到的探测包进行响应时它的期望收益最大，而a* 表示攻击者根据当前推断采取的最优策略（使其期望收益最大）。

根据不完全信息动态博弈的基本理论以及【31】和【32】的结论可以证明APSB模型存在贝叶斯纳什均衡。

\par Bayesian Nash equilibrium of the APS-B is a combination of strategies $(\theta^*,a_1^*)$ and posterior beliefs $p~(t_i|a_2)$.It satisfies:

\begin{enumerate}[(1)]

\item $a_1^{*}$ \in argmax $U_a(t_i,\theta,a_1)$.

\item $ \theta ^{*}$ \in argmax $U_d(t_i,\theta,a_1)$.

\item $p~(t_i|a_2)$ is obtained according to the prior belief $P$,the observed action $a_2$ and the optimal strategy $\theta^*$ by the attacker who uses Bayesian rules.

\end{enumerate}

\par In the aforementioned definition,$\theta^* $ represents the optimal strategy taken by the defender against the action chosen by the attacker after giving the posterior belief,

)

在本小节中我们将定义APS-BG模型的贝叶斯混合策略纳什均衡及其最优化问题

APSB模型的贝叶斯混合策略纳什均衡由一组策略组合（θ* ，a* ）及推断P~组成。它满足以下要求：

（1）θ* 是使得等式（ud）取得最大值的点

（2）P~（ti|a1）是攻击方利用贝叶斯规则根据观察到防御方的行动a1、先验概率p以及防御方的最优策略θ* 得到。

（3）a * 是使得等式（Ua）最大的点

APS-BG模型是一个多轮博弈模型，防御者在博弈开始前确定其混合策略θ且直到博弈结束θ的值都不再改变，而在每一轮博弈中除非攻击者当前的推断P~小于其耐心δ，否则它会以1的概率选择probe。

#### 4.3推断更新规则

根据上述内容可知，推断本质上是攻击者根据观察到防御者的行动然后对防御者类型（端口开放与否）判断的更新，推断决定了攻击者的应采取怎样的策略。

博弈开始之前，防御者确定其混合策略θ且直到博弈结束θ的值都不再改变，攻击者对端口状态的先验概率表示为$p={p_1,p_2}$，其中p1表示防御者的类型为端口开放，p2表示防御者的类型为端口关闭。当博弈进行到第k(k>=1)轮时，攻击者根据观察到的防御者的行动a2以及第（k-1）轮的先验概率按以下规则对推断进行更新，基于防御方只有响应与否两种策略，下面分两种情况讨论推断更新规则：

##### case1：观察到端口响应

in this case 观察到端口响应意味着后验概率为1，即攻击者探测成功博弈结束。

##### case2：防御者不响应（nr）

其中pnr表示防御者不响应的概率，这是攻击者观察到的，因此pnr=1

由上可知p(nr|t1)表示防御者的混合策略θ

显然round k-1 的推断就是round k 的先验概率，我们有：

我们可以通过以下公式计算round k 的推断：

值得注意的是，在APS-BG模型中推断是共同知识也就是防御方也知道攻击者对自己类型的估计概率，这是因为eq.(10)中的每一项都是都是防御方知道的。基于此分析我知防御方可能存在一个最优的混合策略θ使其期望收益最大。

#### 4.4最优防御混合策略选取

APS-BG模型中防御者增大不响应概率$\theta$虽然可以阻止攻击者探测端口，但这也会产生成本C_d例如：某些不响应探测包的策略可能导致误报和误判，合法用户的请求也可能被拒绝或阻止从而影响正常的网络通信等。基于此分析在APS-BG模型中防御者存在一个最优混合策略θ* 使其在成本可接受的情况下取得理想的防御效果，也就是防御者的期望收益取得最大值。下面是防御方最优混合策略θ* 的形式化表示:

基于APS-BG的收益函数形式，我们在论文中使用近似梯度下降算法求解优混合策略θ* 由于导数形式无法确定我们使用差分法来估计梯度，差分法通过计算函数在微小增量下的变化来估计梯度。

通过该算法可以得到近似的最优防御混合策略
